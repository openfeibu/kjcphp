var pickuptime = {
	init: function(a, arr ,b) {
		this.setuptime = a;
		this.run(b,arr)
	},
	marketgetTime: function() {
		var k = this.setuptime;
		var g = new Date();
		g.setDate(g.getDate() + k);
		var h = g.getDay();
		var l = g.getHours();
		var m = g.getMinutes();
		var f = parseInt(h);
		var d = "";
		var a = ["周日", "周一", "周二", "周三", "周四", "周五", "周六"];
		var e = new Array();
		var hs = new Array();
		var b, j;
		for (var c = k; c < 3 + k; c++) {
			if (f == 7) {
				f = 0
			}
			if (c == 0) {
				b = g.getMonth() + 1;
				j = g.getDate();
			
				e.push(b + "月" + j + "日 " + a[f] + " (今天)")
			} else {
				if (c == 1) {
					g.setDate(g.getDate() + 1);
					b = g.getMonth() + 1;
					j = g.getDate();
				
					e.push(b + "月" + j + "日 " + a[f] + " (明天)")
				} else {
					if (c == 2) {
						g.setDate(g.getDate() + 1);
						b = g.getMonth() + 1;
						j = g.getDate();
						
						e.push(b + "月" + j + "日 " + a[f] + " (后天)")
					} else {
						g.setDate(g.getDate() + 1);
						b = g.getMonth() + 1;
						j = g.getDate();
					
						e.push(b + "月" + j + "日 " + a[f])
					}
				}
			}
			f++;
			j++;
		}
		stringTime = l + ':'+ m;
		e.push(stringTime);
		//console.log(stringTime);
		return e
	},
	todoble: function(a) {
		if (a < 10) {
			a = "0" + a + ":00"
		} else {
			a = a + ":00"
		}
		return a
	},
	run: function(f,arr) {
		var c = this.marketgetTime();
		var a = "";
		var nowTime = c[3].split(':');
		var sjTime ;
		var jt;
		var str = "";

		
		for (var b = 0; b < arr.length; b++) {
			sjTime = arr[b].split(':');

			if(nowTime[0] > sjTime[0] || (nowTime[0] == sjTime[0] && nowTime[1] >= sjTime[1]))
			{	
				jt = 0;
				a += "<li class='pickuptime pickuptime-sp hide'>" + arr[b] + "</li>"
			}else{

				jt = 1;
				a += "<li class='pickuptime'>" + arr[b] + "</li>"
				
			}
		}
		console.log(jt);
		if(jt == 1){
			str = "<p class='pickuptime-datap pickuptime-data-on'>" + c[0] + "</p><p class='pickuptime-datap'>" + c[1] + "</p>";
		}else{
			str = "<p class='pickuptime-datap pickuptime-data-on'>" + c[1] + "</p>";
		}
		var e = "<div id='pickuptimeContener' style='display:none;''><div class='pickuptime-close-empty'></div><div id='pickuptime'><div id='_select_box'  style='display:none;'><p class='pickuptime-title'>选择送达时间</p><div class='pickuptime-box'><div class='pickuptime-data'>"+str+"</div>";
		e += "<ul>" + a + "</ul></div></div></div>";
		if ($("#pickuptimeContener").length > 0) {
			$("#pickuptimeContener").remove()
		}
		$("body").append(e);

		if(jt != 1){
			$('.pickuptime').removeClass('pickuptime-sp').removeClass('hide');
		}
		$("#pickuptimeContener").show();
		$("#pickuptimeContener #_select_box").slideDown('slow',function(){
			var d = $("#pickuptimeContener #_select_box").offset().top;
			$(".pickuptime-close-empty").css("height", d + "px");
		});
		
		$(".pickuptime-close-empty,.pickuptime-close").on("click",
		function() {
			$("#pickuptimeContener").remove()
		});
		$(".pickuptime-datap").on("click",
		function() {
			var g = $(this).index();
			if (g != 0) {
				$(".pickuptime-sp").show()
			} else {
				$(".pickuptime-sp").hide()
			}
			$(this).addClass("pickuptime-data-on").siblings().removeClass("pickuptime-data-on")
		});
		$(".pickuptime").on("click",
		function() {
			$(this).addClass("pickuptime-on").siblings().removeClass("pickuptime-on");
			var g = $(".pickuptime-data-on").text() + " " + $(".pickuptime-on").text();
			$(".pickuptime-close-empty").click();
			if (Object.prototype.toString.call(f) === "[object Function]") {
				f(g)
			} else {
				return false
			}
		})
	}
};